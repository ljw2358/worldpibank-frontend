<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>World Pi Bank â€” Web3 + AI</title>
  <meta name="theme-color" content="#4B0082">

  <!-- Inline PWA manifest (ì•„ì´ì½˜ ë‚´ì¥) -->
  <link rel="manifest" href='data:application/manifest+json,{
    "name":"World Pi Bank",
    "short_name":"PiBank",
    "start_url":".",
    "display":"standalone",
    "background_color":"#4B0082",
    "theme_color":"#4B0082",
    "icons":[
      {"src":"data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><rect fill=\"%234B0082\" width=\"512\" height=\"512\" rx=\"96\"/><text x=\"50%\" y=\"58%\" text-anchor=\"middle\" font-size=\"300\" fill=\"white\" font-family=\"Arial, Helvetica, sans-serif\">Ï€</text></svg>","sizes":"192x192","type":"image/svg+xml"},
      {"src":"data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><rect fill=\"%234B0082\" width=\"512\" height=\"512\" rx=\"96\"/><text x=\"50%\" y=\"58%\" text-anchor=\"middle\" font-size=\"300\" fill=\"white\" font-family=\"Arial, Helvetica, sans-serif\">Ï€</text></svg>","sizes":"512x512","type":"image/svg+xml"}
    ]
  }'>
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Crect fill='%234B0082' width='512' height='512' rx='96'/%3E%3Ctext x='50%25' y='58%25' text-anchor='middle' font-size='300' fill='white' font-family='Arial, Helvetica, sans-serif'%3E%CF%80%3C/text%3E%3C/svg%3E'>

  <style>
    :root{ --purple:#4B0082; --white:#fff; }
    *{ box-sizing:border-box; }
    body{ margin:0; font-family:Arial,"Noto Sans CJK KR","Noto Sans SC",sans-serif; background:var(--purple); color:var(--white); padding:18px; text-align:center; }
    .wrap{ max-width:920px; margin:0 auto; }
    h1{ margin:6px 0 4px; font-size:1.4rem; }
    .slogan{ margin:10px 0 16px; line-height:1.5; opacity:.95; }
    .services{ display:flex; flex-direction:column; gap:10px; align-items:center; margin:12px 0; }
    .btn{ display:block; width:100%; max-width:420px; padding:12px; background:#fff; color:var(--purple); border-radius:10px; font-weight:700; text-decoration:none; }
    .card{ background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12); border-radius:12px; padding:14px; text-align:left; margin:12px auto; max-width:880px; }
    .muted{ opacity:.9; font-size:.92rem; }
    .footer{ font-size:.85rem; opacity:.85; margin-top:12px; }
    .row{ display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin-top:8px; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>ğŸŒ ì›”ë“œíŒŒì´ì€í–‰ / World Pi Bank / ä¸–ç•Œæ´¾é“¶è¡Œ</h1>
    <div class="slogan">
      KR: <b>Web3 + AI</b>ë¡œ ì‘ë™í•˜ëŠ” ì„¸ê³„ ìµœì´ˆì˜ ë””ì§€í„¸ ì€í–‰<br>
      EN: The worldâ€™s first digital bank powered by <b>Web3 + AI</b><br>
      ZH: ç”±<b>Web3ä¸AI</b>é©±åŠ¨çš„å…¨çƒé¦–ä¸ªæ•°å­—é“¶è¡Œ
    </div>

    <!-- Pi SDK ë°ëª¨ (Pi Browserì—ì„œë§Œ ë™ì‘) -->
    <div class="row">
      <a class="btn" href="#" onclick="doAuth();return false;">ğŸ” Pi ë¡œê·¸ì¸ / Login / ç™»å½•</a>
      <a class="btn" href="#" onclick="doPayment();return false;">ğŸ’³ ìƒŒë“œë°•ìŠ¤ ê²°ì œ / Payment / æ”¯ä»˜</a>
    </div>

    <!-- 6ëŒ€ ì„œë¹„ìŠ¤ -->
    <div class="services">
      <a class="btn" href="#">ì†¡ê¸ˆ Â· Transfer Â· è½¬è´¦</a>
      <a class="btn" href="#">ê²°ì œ Â· Payment Â· æ”¯ä»˜</a>
      <a class="btn" href="#">ë¦¬ì›Œë“œ Â· Rewards Â· å¥–åŠ±</a>
      <a class="btn" href="#">ì˜ˆì¹˜ Â· Deposit Â· å­˜æ¬¾</a>
      <a class="btn" href="#">ê¸°ë³¸ì†Œë“ Â· UBI Â· åŸºæœ¬æ”¶å…¥</a>
      <a class="btn" href="#faq">ê³ ê°ì„¼í„° Â· FAQ Â· å®¢æœ</a>
    </div>

    <!-- README / Contact -->
    <div class="card">
      <b>README</b><br>
      Demo(GitHub Pages): ì´ í˜ì´ì§€ URL<br>
      Pi Browser: pi://worldpibank (App Studio ë“±ë¡ ì˜ˆì •)<br>
      Contact: <a href="mailto:ljw2358@naver.com" style="color:#fff">ljw2358@naver.com</a><br>
      <span class="muted">Built on Web3 Â· Powered by AI</span>
    </div>

    <!-- Vision -->
    <div class="card">
      <b>Vision / ë¹„ì „ / æ„¿æ™¯</b>
      <p class="muted">
        KR: Web3 ì§€ê°‘=ì‹ ì›, AIê°€ ì´ìƒê±°ë˜ íƒì§€Â·ìŠ¤í…Œì´í‚¹ ì¶”ì²œÂ·ìë™ê²°ì œë¥¼ ì§€ì›í•©ë‹ˆë‹¤.<br>
        EN: Wallet-as-identity; AI for fraud detection, staking recommendations & auto-payments.<br>
        ZH: Web3é’±åŒ…å³èº«ä»½ï¼›AIç”¨äºå¼‚å¸¸æ£€æµ‹ã€è´¨æŠ¼æ¨èä¸è‡ªåŠ¨æ”¯ä»˜ã€‚
      </p>
    </div>

    <!-- FAQ(ê¸°ë³¸) + ë°±ì—”ë“œì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸° ë²„íŠ¼ -->
    <div id="faq" class="card">
      <b>FAQ (ê¸°ë³¸ í‘œì‹œ)</b>
      <p><b>Q1. KYC?</b><br>KR: ë¡œì»¬ ì•”í˜¸í™” ê²€ì¦â€¦ / EN: Local encrypted verificationâ€¦ / ZH: æœ¬åœ°åŠ å¯†éªŒè¯â€¦</p>
      <p><b>Q2. ë³´ì•ˆ?</b><br>KR: í•˜ë“œì›¨ì–´ í‚¤, ë‹¤ì¤‘ì„œëª…â€¦ / EN: Hardware keys, multi-sigâ€¦ / ZH: ç¡¬ä»¶å¯†é’¥ã€å¤šé‡ç­¾åâ€¦</p>
      <a class="btn" href="#" onclick="fetchFAQFromBackend();return false;">ğŸ”„ ë°±ì—”ë“œì—ì„œ FAQ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê¸°</a>
    </div>

    <div class="card">
      <a class="btn" href="#" onclick="fetchTxFromBackend();return false;">ğŸ’° ê±°ë˜ë‚´ì—­ ë¶ˆëŸ¬ì˜¤ê¸° (Backend)</a>
    </div>

    <div class="footer">PWAë¡œ í™ˆí™”ë©´ì— ì¶”ê°€ ê°€ëŠ¥ Â· ì¼ë¶€ ê¸°ëŠ¥ì€ ë°ëª¨ìš©ì…ë‹ˆë‹¤.</div>
  </div>

  <!-- Pi SDK -->
  <script src="https://downloads.minepi.com/sdk/v1/prod.js"></script>

  <script>
    // âœ… ë°°í¬ëœ ë°±ì—”ë“œ URL
    const API_BASE = "https://worldpibank-backend.onrender.com";

    // Pi SDK init (Pi Browser)
    if (window.Pi && Pi.init) {
      Pi.init({ version: "2.0", sandbox: true });
    }

    async function doAuth(){
      try {
        if (!window.Pi || !Pi.authenticate) return alert("Pi Browserì—ì„œ ì—´ì–´ì£¼ì„¸ìš”.");
        const auth = await Pi.authenticate(['username','payments']);
        alert("Logged in as @" + (auth.user?.username || "unknown"));
      } catch (e) { console.error(e); alert("ë¡œê·¸ì¸ ì‹¤íŒ¨"); }
    }

    function doPayment(){
      if (!window.Pi || !Pi.createPayment) return alert("Pi Browserì—ì„œ ì—´ì–´ì£¼ì„¸ìš”.");
      const paymentData = { amount: 3.14, memo: "World Pi Bank Demo", metadata:{ itemId:"demo-001" } };
      const cbs = {
        onReadyForServerApproval: (paymentId) => {
          fetch(API_BASE + "/payments/approve", {
            method: "POST", headers: { "Content-Type":"application/json" },
            body: JSON.stringify({ paymentId })
          }).catch(console.error);
        },
        onReadyForServerCompletion: (paymentId, txid) => {
          fetch(API_BASE + "/payments/complete", {
            method: "POST", headers: { "Content-Type":"application/json" },
            body: JSON.stringify({ paymentId, txid })
          }).catch(console.error);
        },
        onCancel: () => alert("ê²°ì œ ì·¨ì†Œ"),
        onError: (err) => { console.error(err); alert("ê²°ì œ ì˜¤ë¥˜"); }
      };
      try { Pi.createPayment(paymentData, cbs); } catch(e){ console.error(e); alert("ê²°ì œ ì‹œì‘ ì‹¤íŒ¨"); }
    }

    async function fetchFAQFromBackend(){
      try {
        const r = await fetch(API_BASE + "/faq");
        const data = await r.json();
        const html = data.map(x => `<p>â“ ${x.q}<br>KR: ${x.a_kr}<br>EN: ${x.a_en}<br>ZH: ${x.a_zh}</p>`).join("");
        document.getElementById("faq").innerHTML = "<b>FAQ (from backend)</b>" + html;
      } catch(e){ console.error(e); alert("FAQ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨"); }
    }

    async function fetchTxFromBackend(){
      try {
        const r = await fetch(API_BASE + "/transactions");
        const data = await r.json();
        alert("Transactions: " + JSON.stringify(data));
      } catch(e){ console.error(e); alert("ê±°ë˜ë‚´ì—­ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨"); }
    }

    // ê°„ë‹¨ PWA SW ë“±ë¡
    const swCode = `
      self.addEventListener('install', e => {
        e.waitUntil(caches.open('wpb-v1').then(c=>c.addAll(['.'])));
      });
      self.addEventListener('fetch', e => {
        e.respondWith(caches.match(e.request).then(r=>r||fetch(e.request)));
      });
    `;
    if ('serviceWorker' in navigator) {
      const blob = new Blob([swCode], { type: 'text/javascript' });
      const url = URL.createObjectURL(blob);
      navigator.serviceWorker.register(url).catch(()=>{});
    }
  </script>
</body>
</html>
